<Window x:Class="MaxiMed.Wpf.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:MaxiMed.Wpf.Views"
        mc:Ignorable="d"
        Title="MaxiMed"
        Height="800"
        Width="1400"
        Background="{DynamicResource BgBrush}"
        FontFamily="Segoe UI"
        TextElement.FontSize="13"
        SnapsToDevicePixels="True"
        Icon="/Resources/Image/Image.ico">

    <Window.Resources>
        <!-- Базовые цвета -->
        <Color x:Key="C_Primary">#2563EB</Color>
        <Color x:Key="C_PrimaryDark">#1D4ED8</Color>
        <Color x:Key="C_Text">#0F172A</Color>
        <Color x:Key="C_SubText">#64748B</Color>
        <Color x:Key="C_Border">#E2E8F0</Color>
        <Color x:Key="C_SidebarBg">#FFFFFF</Color>

        <SolidColorBrush x:Key="B_Primary" Color="{StaticResource C_Primary}"/>
        <SolidColorBrush x:Key="B_PrimaryDark" Color="{StaticResource C_PrimaryDark}"/>
        <SolidColorBrush x:Key="B_Text" Color="{StaticResource C_Text}"/>
        <SolidColorBrush x:Key="B_SubText" Color="{StaticResource C_SubText}"/>
        <SolidColorBrush x:Key="B_Border" Color="{StaticResource C_Border}"/>
        <SolidColorBrush x:Key="B_SidebarBg" Color="{StaticResource C_SidebarBg}"/>

        <DropShadowEffect x:Key="E_SoftShadow"
                          BlurRadius="28"
                          ShadowDepth="8"
                          Opacity="0.14"/>
        <Style x:Key="S_NavToggle" TargetType="ToggleButton">
            <Setter Property="Height" Value="40"/>
            <Setter Property="Padding" Value="10,0"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Foreground" Value="{DynamicResource TextPrimary}"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToggleButton">
                        <Border x:Name="Bd"
        Background="{TemplateBinding Background}"
        CornerRadius="10">
                            <Border.RenderTransform>
                                <ScaleTransform ScaleX="1" ScaleY="1"/>
                            </Border.RenderTransform>
                            <Border.RenderTransformOrigin>0.5,0.5</Border.RenderTransformOrigin>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="4"/>
                                    <ColumnDefinition Width="22"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- Акцентная полоска слева -->
                                <Border x:Name="ActiveBar"
                Grid.Column="0"
                Background="Transparent"
                CornerRadius="10,0,0,10"/>

                                <!-- Иконка -->
                                <Viewbox Grid.Column="1" Width="16" Height="16" Margin="6,0,0,0" VerticalAlignment="Center">
                                    <ContentPresenter x:Name="IconPresenter" Content="{TemplateBinding Tag}"/>
                                </Viewbox>

                                <!-- Текст -->
                                <ContentPresenter Grid.Column="2"
                          Margin="10,0,8,0"
                          VerticalAlignment="Center"/>
                            </Grid>
                        </Border>


                        <ControlTemplate.Triggers>
                            <!-- Hover -->
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="{DynamicResource NavHoverBg}"/>
                            </Trigger>


                            <!-- Active -->
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="{DynamicResource AccentSoftBrush}"/>
                                <Setter TargetName="ActiveBar" Property="Background" Value="{DynamicResource AccentBrush}"/>
                                <Setter Property="Foreground" Value="{DynamicResource AccentBrush}"/>
                            </Trigger>


                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="Bd" Property="Opacity" Value="0.55"/>
                            </Trigger>
                            <EventTrigger RoutedEvent="MouseEnter">
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="Bd"
                             Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                             To="1.02" Duration="0:0:0.10"/>
                                        <DoubleAnimation Storyboard.TargetName="Bd"
                             Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                             To="1.02" Duration="0:0:0.10"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>

                            <EventTrigger RoutedEvent="MouseLeave">
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="Bd"
                             Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                             To="1" Duration="0:0:0.10"/>
                                        <DoubleAnimation Storyboard.TargetName="Bd"
                             Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                             To="1" Duration="0:0:0.10"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>

                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Общий стиль для пунктов меню -->
        <Style x:Key="S_NavButton" TargetType="Button">
            <Setter Property="Height" Value="40"/>
            <Setter Property="Padding" Value="10,0"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Foreground" Value="{DynamicResource TextPrimary}"/>

            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Bd"
                                Background="{TemplateBinding Background}"
                                CornerRadius="10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="26"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- Иконка -->
                                <Viewbox Width="16" Height="16" Margin="6,0,0,0" VerticalAlignment="Center">
                                    <ContentPresenter x:Name="IconPresenter"
                                                      Content="{TemplateBinding Tag}"/>
                                </Viewbox>

                                <!-- Текст -->
                                <ContentPresenter Grid.Column="1"
                                                  Margin="10,0,8,0"
                                                  VerticalAlignment="Center"/>
                            </Grid>
                        </Border>

                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#0B000000"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#12000000"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="Bd" Property="Background"
        Value="{DynamicResource ControlBgHover}"/>

                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Кнопка "Выход" чуть акцентнее -->
        <Style x:Key="S_LogoutButton" TargetType="Button" BasedOn="{StaticResource S_NavButton}">
            <Setter Property="Foreground" Value="#991B1B"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Bd"
                                Background="{TemplateBinding Background}"
                                CornerRadius="10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="26"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <Viewbox Width="16" Height="16" Margin="6,0,0,0" VerticalAlignment="Center">
                                    <ContentPresenter Content="{TemplateBinding Tag}"/>
                                </Viewbox>

                                <ContentPresenter Grid.Column="1"
                                                  Margin="10,0,8,0"
                                                  VerticalAlignment="Center"/>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#10DC2626"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#1ADC2626"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Иконки (простые векторные через Path, без библиотек) -->
        <Geometry x:Key="I_Users">M12,12 C14.2,12 16,10.2 16,8 C16,5.8 14.2,4 12,4 C9.8,4 8,5.8 8,8 C8,10.2 9.8,12 12,12 Z M4,20 C4,16.7 7.6,14.5 12,14.5 C16.4,14.5 20,16.7 20,20</Geometry>
        <Geometry x:Key="I_Doctor">M11,4 h2 v6 h6 v2 h-6 v6 h-2 v-6 h-6 v-2 h6 z</Geometry>
        <Geometry x:Key="I_List">M5,6 h14 v2 h-14 z M5,11 h14 v2 h-14 z M5,16 h14 v2 h-14 z</Geometry>
        <Geometry x:Key="I_Building">M6,20 v-14 h12 v14 M9,20 v-3 h2 v3 M13,20 v-3 h2 v3</Geometry>
        <Geometry x:Key="I_Calendar">M7,4 v2 M17,4 v2 M5,8 h14 v12 h-14 z M7,10 h3 v3 h-3 z</Geometry>
        <Geometry x:Key="I_Clock">M12,4 a8,8 0 1 0 0.001,0 z M12,8 v5 l3,2</Geometry>
        <Geometry x:Key="I_Report">M6,20 v-14 h12 v14 M9,16 v-6 M12,16 v-3 M15,16 v-8</Geometry>
        <Geometry x:Key="I_Admin">M12,4 l7,4 v6 c0,4-3,7-7,8 c-4-1-7-4-7-8 v-6 z</Geometry>
        <Geometry x:Key="I_Exit">M10,7 v-2 h10 v14 h-10 v-2 M10,12 h-6 M6,12 l3,-3 M6,12 l3,3</Geometry>
        <Geometry x:Key="I_Settings">
            M19.14,12.94a7.49,7.49,0,0,0,.05-.94,7.49,7.49,0,0,0-.05-.94l2.03-1.58a.5.5,0,0,0,.12-.64l-1.92-3.32a.5.5,0,0,0-.6-.22l-2.39.96a7.28,7.28,0,0,0-1.63-.94l-.36-2.54A.5.5,0,0,0,13.9,1H10.1a.5.5,0,0,0-.49.42L9.25,3.96a7.28,7.28,0,0,0-1.63.94l-2.39-.96a.5.5,0,0,0-.6.22L2.71,7.48a.5.5,0,0,0,.12.64L4.86,9.7a7.49,7.49,0,0,0-.05.94,7.49,7.49,0,0,0,.05.94L2.83,14.16a.5.5,0,0,0-.12.64l1.92,3.32a.5.5,0,0,0,.6.22l2.39-.96a7.28,7.28,0,0,0,1.63.94l.36,2.54a.5.5,0,0,0,.49.42h3.8a.5.5,0,0,0,.49-.42l.36-2.54a7.28,7.28,0,0,0,1.63-.94l2.39.96a.5.5,0,0,0,.6-.22l1.92-3.32a.5.5,0,0,0-.12-.64ZM12,15.5A3.5,3.5,0,1,1,15.5,12,3.5,3.5,0,0,1,12,15.5Z
        </Geometry>


        <Style x:Key="S_IconPath" TargetType="Path">
            <Setter Property="Stroke" Value="{DynamicResource TextSecondary}"/>
            <Setter Property="StrokeThickness" Value="1.8"/>
            <Setter Property="StrokeStartLineCap" Value="Round"/>
            <Setter Property="StrokeEndLineCap" Value="Round"/>
            <Setter Property="StrokeLineJoin" Value="Round"/>
            <Setter Property="Fill" Value="Transparent"/>
        </Style>
    </Window.Resources>

    <DockPanel>

        <!-- Левый сайдбар -->
        <Border DockPanel.Dock="Left"
                Width="280"
                Background="{DynamicResource CardBrush}"
BorderBrush="{DynamicResource BorderBrushHard}"

                BorderThickness="0,0,1,0">

            <Grid Margin="14">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="14"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Шапка -->
                <StackPanel Grid.Row="0">
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <Border Width="42" Height="42" CornerRadius="12" Background="#EFF6FF" Margin="0,0,12,0">
                            <Image Source="/Resources/Image/Image.png"
                                   Stretch="Uniform"/>
                        </Border>

                        <StackPanel>
                            <TextBlock Text="MaxiMed" Foreground="{DynamicResource TextPrimary}"/>
                        </StackPanel>
                    </StackPanel>
                </StackPanel>

                <!-- Меню -->
                <ScrollViewer Grid.Row="2" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                    <StackPanel Margin="0,2,0,0">

                        <ToggleButton Content="Пациенты"
                                Style="{StaticResource S_NavToggle}"
                                Command="{Binding OpenPatientsCommand}"
                                Visibility="{Binding CanSeePatients, Converter={StaticResource BoolToVisibility}}"
                                IsChecked="{Binding IsPatientsActive,Mode=TwoWay}"
                                Margin="0,0,0,8">
                            <ToggleButton.Tag>
                                <Path Data="{StaticResource I_Users}" Style="{StaticResource S_IconPath}"/>
                            </ToggleButton.Tag>
                        </ToggleButton>

                        <ToggleButton Content="Врачи"
                                Style="{StaticResource S_NavToggle}"
                                Command="{Binding OpenDoctorsCommand}"
                                Visibility="{Binding CanSeeDoctors, Converter={StaticResource BoolToVisibility}}"
                                IsChecked="{Binding IsDoctorsActive ,Mode=TwoWay}"
                                Margin="0,0,0,8">
                            <ToggleButton.Tag>
                                <Path Data="{StaticResource I_Doctor}" Style="{StaticResource S_IconPath}"/>
                            </ToggleButton.Tag>
                        </ToggleButton>

                        <ToggleButton Content="Специализации"
                                Style="{StaticResource S_NavToggle}"
                                Command="{Binding OpenSpecialtiesCommand}"
                                Visibility="{Binding CanSeeSpecialties, Converter={StaticResource BoolToVisibility}}"
                                IsChecked="{Binding IsSpecialtiesActive  ,Mode=TwoWay}"                                     
                                Margin="0,0,0,8">
                            <ToggleButton.Tag>
                                <Path Data="{StaticResource I_List}" Style="{StaticResource S_IconPath}"/>
                            </ToggleButton.Tag>
                        </ToggleButton>

                        <ToggleButton Content="Филиалы"
                                Style="{StaticResource S_NavToggle}"
                                Command="{Binding OpenBranchesCommand}"
                                Visibility="{Binding CanOpenBranches, Converter={StaticResource BoolToVisibility}}"
                                IsChecked="{Binding IsBranchesActive ,Mode=TwoWay}"
                                Margin="0,0,0,8">
                            <ToggleButton.Tag>
                                <Path Data="{StaticResource I_Building}" Style="{StaticResource S_IconPath}"/>
                            </ToggleButton.Tag>
                        </ToggleButton>

                        <ToggleButton Content="Записи (день)"
                                Style="{StaticResource S_NavToggle}"
                                Command="{Binding OpenAppointmentsCommand}"
                                Visibility="{Binding CanSeeAppointments, Converter={StaticResource BoolToVisibility}}"
                                IsChecked="{Binding IsAppointmentsActive ,Mode=TwoWay}"
                                Margin="0,0,0,8">
                            <ToggleButton.Tag>
                                <Path Data="{StaticResource I_Calendar}" Style="{StaticResource S_IconPath}"/>
                            </ToggleButton.Tag>
                        </ToggleButton>

                        <ToggleButton Content="Расписание (день)"
                                Style="{StaticResource S_NavToggle}"
                                Command="{Binding OpenScheduleCommand}"
                                Visibility="{Binding CanSeeScheduleDay, Converter={StaticResource BoolToVisibility}}"
                                IsChecked="{Binding IsScheduleActive  ,Mode=TwoWay}"
                                Margin="0,0,0,8">
                            <ToggleButton.Tag>
                                <Path Data="{StaticResource I_Clock}" Style="{StaticResource S_IconPath}"/>
                            </ToggleButton.Tag>
                        </ToggleButton>

                        <ToggleButton Content="Неделя врача"
                                Style="{StaticResource S_NavToggle}"
                                Command="{Binding OpenWeekScheduleCommand}"
                                Visibility="{Binding CanSeeWeekSchedule, Converter={StaticResource BoolToVisibility}}"
                                IsChecked="{Binding IsWeekScheduleActive  ,Mode=TwoWay}"
                                Margin="0,0,0,8">
                            <ToggleButton.Tag>
                                <Path Data="{StaticResource I_Calendar}" Style="{StaticResource S_IconPath}"/>
                            </ToggleButton.Tag>
                        </ToggleButton>

                        <ToggleButton Content="Свободное время"
                                Style="{StaticResource S_NavToggle}"
                                Command="{Binding OpenFreeSlotsCommand}"
                                Visibility="{Binding CanSeeFreeSlots, Converter={StaticResource BoolToVisibility}}"
                                IsChecked="{Binding IsFreeSlotsActive  ,Mode=TwoWay}"
                                Margin="0,0,0,8">
                            <ToggleButton.Tag>
                                <Path Data="{StaticResource I_Clock}" Style="{StaticResource S_IconPath}"/>
                            </ToggleButton.Tag>
                        </ToggleButton>

                        <ToggleButton Content="Диагнозы"
                                Style="{StaticResource S_NavToggle}"
                                Command="{Binding OpenDiagnosesCommand}"
                                Visibility="{Binding CanSeeDiagnoses, Converter={StaticResource BoolToVisibility}}"
                                IsChecked="{Binding IsDiagnosesActive  ,Mode=TwoWay}"
                                Margin="0,0,0,8">
                            <ToggleButton.Tag>
                                <Path Data="{StaticResource I_List}" Style="{StaticResource S_IconPath}"/>
                            </ToggleButton.Tag>
                        </ToggleButton>

                        <ToggleButton Content="Услуги"
                                Style="{StaticResource S_NavToggle}"
                                Command="{Binding OpenServicesCommand}"
                                Visibility="{Binding CanSeeServices, Converter={StaticResource BoolToVisibility}}"
                                      IsChecked="{Binding IsServicesActive  ,Mode=TwoWay}"
                                Margin="0,0,0,8">
                            <ToggleButton.Tag>
                                <Path Data="{StaticResource I_List}" Style="{StaticResource S_IconPath}"/>
                            </ToggleButton.Tag>
                        </ToggleButton>

                        <ToggleButton Content="Отчеты"
                                Style="{StaticResource S_NavToggle}"
                                Command="{Binding OpenReportsCommand}"
                                Visibility="{Binding CanSeeReports, Converter={StaticResource BoolToVisibility}}"
                                IsChecked="{Binding IsReportsActive  ,Mode=TwoWay}"
                                Margin="0,0,0,8">
                            <ToggleButton.Tag>
                                <Path Data="{StaticResource I_Report}" Style="{StaticResource S_IconPath}"/>
                            </ToggleButton.Tag>
                        </ToggleButton>

                        <Separator Margin="0,10,0,10"
                                   Visibility="{Binding CanSeeAdminPanel, Converter={StaticResource BoolToVisibility}}"/>

                        <ToggleButton Content="Администрирование"
                                Style="{StaticResource S_NavToggle}"
                                Command="{Binding OpenAdminCommand}"
                                Visibility="{Binding CanSeeAdminPanel, Converter={StaticResource BoolToVisibility}}"
                                IsChecked="{Binding IsAdminActive  ,Mode=TwoWay}"
                                Margin="0,0,0,8">
                            <ToggleButton.Tag>
                                <Path Data="{StaticResource I_Admin}" Style="{StaticResource S_IconPath}"/>
                            </ToggleButton.Tag>
                        </ToggleButton>
                        <ToggleButton Content="Настройки"
                                Style="{StaticResource S_NavToggle}"
                                Command="{Binding OpenSettingsCommand}"
                                IsChecked="{Binding IsSettingsActive  ,Mode=TwoWay}"
                                Margin="0,0,0,8">
                            <ToggleButton.Tag>
                                <Path Data="{StaticResource I_Settings}" Style="{StaticResource S_IconPath}"/>
                            </ToggleButton.Tag>
                        </ToggleButton>

                    </StackPanel>
                </ScrollViewer>

                <!-- Нижняя зона -->
                <StackPanel Grid.Row="3" Margin="0,10,0,0">
                    <Separator Margin="0,0,0,10"/>

                    <Button Content="Завершение работы"
                            Style="{StaticResource S_LogoutButton}"
                            Command="{Binding LogoutCommand}">
                        <Button.Tag>
                            <Path Data="{StaticResource I_Exit}" Style="{StaticResource S_IconPath}"/>
                        </Button.Tag>
                    </Button>
                    <Button Content="Выход из учетной записи"
                            Style="{StaticResource S_LogoutButton}"
                            Command="{Binding LogoutUserCommand}">
                        <Button.Tag>
                            <Path Data="{StaticResource I_Exit}" Style="{StaticResource S_IconPath}"/>
                        </Button.Tag>
                    </Button>
                   


                </StackPanel>
            </Grid>
        </Border>

        <!-- Контентная зона -->
        <Grid Margin="18">
            <Border x:Name="ContentHost"
        Background="{DynamicResource CardBrush}"
        CornerRadius="16"
        BorderBrush="{DynamicResource BorderBrushHard}"
        BorderThickness="1"
        Effect="{StaticResource E_SoftShadow}">
                <Border.RenderTransform>
                    <TranslateTransform Y="0"/>
                </Border.RenderTransform>

                <Frame x:Name="MainFrame"
           NavigationUIVisibility="Hidden"
           Background="Transparent"/>
            </Border>

        </Grid>

    </DockPanel>
</Window>
